# Running PHONEMeS

Running PHONEMeS-ILP is easy and straightforward once you have downloaded and installed [R](https://www.r-project.org/) on your computer and get a license for the [IBM CPLEX Optimizer](https://ibm.onthehub.com/) which can be obtained for free for academic use. Also required is to have installed the supportive R packages mentioned in the main [README](https://github.com/saezlab/PHONEMeS-ILP).

The pipeline is the same for all the case studies present in the Examples folder:

## Data input

* Download and save the data in a local folder where you wish to perform the analysis. The data folder will typically contain a background network containing a set of possible kinase to substrate interactions which we might obtain from multiple online data-bases such as [OmniPath](http://omnipathdb.org/ptms?types=phosphorylation,dephosphorylation). This folder will also contain the results from the Gaussian Mixture Model (GMM).

* On your working directory, download and save the files present on the [Public](https://github.com/saezlab/PHONEMeS-ILP/tree/master/Public) repository. These are mainly the scripts containing the functions which implement the ILP method. Also on this folder you will find the `.txt` files containing the commands which will be passed to the `cplex` executable.

* On your working directory, download and save the files present on the Codes folder (`buildDataMatrix.R` and `executionScript.R`) of the corresponding example.

## Running the scripts
1) Execute the `buildDataMatrix.R` and `ilpFunctions.R` scripts in order to write the objective function, bounds and constraints of the ILP problem.

2) Then execute the `executionScript.R` in order to solve the optimization problem and obtain the final `resultsSIF.txt` file which is basically the resulting network generated by PHONEMeS representing the optimal reconstructed pathway activity model and which can be easily visualized in [Cytoscape](https://cytoscape.org/).


## Network Visualization

* *resultsSIF.txt* is a *sif* representation of our model and it can be easily loaded and used by Cytoscape for visualization.

* For a nicer visualization of our resulting network, run first the `visualNetwork.R` script of the Codes repository which will assign the node attributes to each of the kinases/phosphosites present in our model. Then, by "Import Table from File" in cytoscape, you import the resulting *nodesAttributes.txt* file by making sure that the column containing the attributes is named `nodesP`.

* Then by “Import Styles” you import the visual properties by selecting the `PHONEMeS_vizmap.props` which can be found on the Results folder.

* Select `default_0` on Styles and then you will get a nice visualization of the network.
